<!DOCTYPE html>
<html>

<!--$
#include "dao.h"

#include <vector>
#include <string>

typedef struct {
    std::vector<dao::account> accounts;
    std::vector<dao::type> types;
    std::vector<dao::expense> expenses;
    std::vector<dao::transaction> transactions;
}transinput_html_input;
$-->

<head>
    <link href="common.css" rel="stylesheet"></link>
    <link href="jquery-ui.min.css" rel="stylesheet"></link>
    <script src="jquery-3.2.1.min.js"></script>
    <script src="jquery-ui.min.js"></script>
    <script src="utils.js"></script>
    <script src="transinput.js"></script>
</head>

<body onload="init()">
    <table id="transactionTable">
        <thead>
            <th>ID</th>
            <th>Amount</th>
            <th>Comment</th>
            <th>Account</th>
            <th>Type</th>
            <th>Expense</th>
            <th>Date</th>
            <th></th>
        </thead>
        <tbody>
            <tr id="transactionDetails">
                <td></td>
                <td><input name="AMOUNT" type="number" step="0.01" value="0.00" placeholder="0.00"></td>
                <td><textarea name="COMMENT" rows="2" cols="40"></textarea></td>
                <td><select name="ACCOUNT" id="accountSelect">
                    <!--%
                    for(dao::account account:input.accounts){
                        %-->
                        <option value="<!--=account.id=-->" ><!--=account.name=--></option>
                        <!--%
                    }
                    %-->
                    </select></td>
                <td><select name="TYPE" id="typeSelect">
                    <!--%
                    for(dao::type type:input.types){
                        %-->
                        <option value="<!--=type.id=-->" ><!--=type.name=--></option>
                        <!--%
                    }
                    %-->
                    </select></td>
                <td><select name="EXPENSE" id="expenseSelect">
                    <!--%
                    for(dao::expense expense:input.expenses){
                        %-->
                        <option value="<!--=expense.id=-->" ><!--=expense.name=--></option>
                        <!--%
                    }
                    %-->
                    </select></td>
                <td><input name="DATE" id="transDate" class="transDate"></td>
                <td><input type="button" onclick="saveTransaction()" value="Save"></td>
            </tr>
            <!--%
            std::vector<dao::transaction>::iterator i = input.transactions.end();
            while (i != input.transactions.begin())
            {
            --i;
            dao::transaction transaction = *i;
            %-->
            <tr id="transaction_<!--=transaction.id=-->">
                <td>
                    <!--=transaction.id=-->
                </td>
                <td><input name="AMOUNT" type="number" step="0.01" value="<!--=transaction.amount=-->" placeholder="0.00"></td>
                <td>
                    <textarea name="COMMENT" rows="2" cols="40"><!--=transaction.comment=--></textarea>
                </td>
                <td class="accountSelect"><input hidden value="<!--=transaction.accountId=-->"></td>
                <td class="typeSelect"><input hidden value="<!--=transaction.typeId=-->"></td>
                <td class="expenseSelect"><input hidden value="<!--=transaction.expenseId=-->"></td>
                <td><input name="DATE" class="transDate" value="<!--=transaction.date=-->"></td>
                <td>
                    <input type="button" onclick="updateTransaction('transaction_<!--=transaction.id=-->')" value="Update">
                    <input type="button" onclick="deleteTransaction('transaction.id')" value="&times;">
                </td>
            </tr>
            <!--%
            }
            %-->
        </tbody>
    </table>
</body>

</html>